---
layout: reference
sitemap: false
---
<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtmlcharset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>BackgroundSubtractorCNT: Usage in a nutshell</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px">
  <td id="projectalign" style="padding-left: 0.5em">
   <div id="projectname">BackgroundSubtractorCNT
   &#160<span id="projectnumber">1.1.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",true,'Search');
</script>
  <div class="doxygen-search-container">
        <div id="MSearchBox" class="MSearchBoxInactive" style="z-index:auto; right:auto; left:0">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
  </div>

        <!-- window showing the filter options -->
        <div id="MSearchSelectWindow"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             onkeydown="return searchBox.OnSearchSelectKey(event)">
        </div>

        <!-- iframe showing the search results (closed by default) -->
  <div class="doxygen-search-results-container">
        <div id="MSearchResultsWindow">
        <iframe src="javascript:void(0)" frameborder="0" 
                name="MSearchResults" id="MSearchResults">
        </iframe>
        </div>
  </div>

  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->

<!-- iframe showing the search results (closed by default) -->

<div class="header">
  <div class="headertitle">
<div class="title">Usage in a nutshell </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is a drop in replacement API for the background subtraction solutions supplied with OpenCV 3.1.0 and above. See these drop in replacement examples for C++ in <a class="el" href="main_8cpp-example.html">main.cpp</a> file, and for python in <a class="el" href="python_2demo_8py-example.html">demo.py</a> file.</p>
<h3>The algorithm</h3>
<p>The algorithm is innovative but very intuative. If something doesn't change then our brain treats it like a background. So we simply count for how many frames a pixel doesn't change (with some treshold of what is considered the same color to deal with dynamic lights). If you understand the usage below then you basically undesrstand the algorthm. The rest is simply C++ coding optimizations.</p>
<h3>Usage tuning</h3>
<p>This module is very predictable as it's behavior follows common sense. You can tune the behavior when the BackgroundSubtractor is created (or later with setters) –</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Ptr&lt;BackgroundSubtractorCNT&gt;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;createBackgroundSubtractorCNT(int minPixelStability = 15,</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;                              bool useHistory = true,</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;                              int maxPixelStability = 15*60,</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;                              bool isParallel = true);</div></div><!-- fragment --><ul>
<li>Use your estimated FPS as the base for tuning, as explained below (it doesn’t have to be accurate).</li>
<li>Each of these parameters can be evaluated according to these guidelines:</li>
</ul>
<h4>How long to wait before considering a pixel to be a background?</h4>
<p>When you and I look at a scene, we wait for some time before we consider an item to be part of a background. The assumption here is that it takes about 1 second, but you can play with it. I recommend using your expected FPS as the value of minPixelStability when using <a class="el" href="namespacecv_1_1bgsubcnt.html#a6a6efd913954320be33f39c32a4c5a7e" title="Create background subtraction based on counting. ">createBackgroundSubtractorCNT()</a>. The value represents the number of frames to wait when a pixel is not changing before marking it as background. The demo is doing exactly that in main.cpp.</p>
<h4>How long to wait before recognizing the background changed?</h4>
<p>Okay – so we’ve set something to be a background, and things are passing in front of it. When something is in front of it for a long time, then it’s time to treat it as a background instead of the previous one, but how long to wait before doing this replacement? The algorithm here was tested with a 60 seconds value and gave good results. You can change that as you want, but I recommend setting maxPixelStability to “minPixelStability*60″ in <a class="el" href="namespacecv_1_1bgsubcnt.html#a6a6efd913954320be33f39c32a4c5a7e" title="Create background subtraction based on counting. ">createBackgroundSubtractorCNT()</a>. The demo is doing exactly that in main.cpp.</p>
<h4>But what if you want to REACT VERY FAST TO SCENE CHANGES?</h4>
<p>If reducing maxPixelStability is not enough, you can use ‘false‘ for useHistory in <a class="el" href="namespacecv_1_1bgsubcnt.html#a6a6efd913954320be33f39c32a4c5a7e" title="Create background subtraction based on counting. ">createBackgroundSubtractorCNT()</a>. In this case maxPixelStability is ignored. Because the background distinction is weaker, you’ll see small ghosts following your foreground objects and the background image will have some ghosts images fading in it. Using “minPixelStability=FPS/5” will reduce this phenomena.</p>
<h4>To parallel or not to parallel?</h4>
<p>In my experience paralleling everything automatically is a double edged sword. On one hand you don’t need to worry about optimizations if you have enough processing power. On the other hand, splitting your processing carefully can yield a better optimization. I leave this to you to experiment and decide for your specific design. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
